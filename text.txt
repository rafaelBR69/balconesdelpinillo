const SHEET_NAME = 'Leads'; // nombre exacto de tu pestaña function doPost(e) { const ss = SpreadsheetApp.getActiveSpreadsheet(); const sheet = ss.getSheetByName(SHEET_NAME) || ss.insertSheet(SHEET_NAME); /* 1. Datos del formulario --------------------------------------- */ const d = JSON.parse(e.postData.contents || '{}'); /* 2. Fecha dd/MM/yyyy (zona de la hoja) -------------------------- */ const tz = ss.getSpreadsheetTimeZone(); const fecha = Utilities.formatDate(new Date(), tz, 'dd/MM/yyyy'); /* 3. Buscar primera fila vacía en columna A ---------------------- */ const startRow = 2; // debajo de los títulos let target = startRow; while (!sheet.getRange(target, 1).isBlank()) { // 1 = columna A target++; } /* 4. Escribir en columnas sueltas (A, C, E, G, P) ---------------- */ sheet.getRange(target, 1).setValue(fecha); // A sheet.getRange(target, 3).setValue(d.origin || 'Formulario Web'); // C sheet.getRange(target, 5).setValue(d.name || ''); // E sheet.getRange(target, 7).setValue(d.phone || ''); // G sheet.getRange(target, 16).setValue(d.message || ''); // P /* 5. Respuesta ---------------------------------------------------- */ return ContentService .createTextOutput('ok') .setMimeType(ContentService.MimeType.TEXT) .setHeader('Access-Control-Allow-Origin', '*'); }